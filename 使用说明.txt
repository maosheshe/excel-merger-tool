Excel文件合并工具使用说明
===================

1. 程序说明
-----------
这是一个用于合并多个Excel文件的工具，专门用于处理施工计划审批表。

2. 使用方法
-----------
1) 双击运行"Excel文件合并工具.exe"
2) 点击"选择Excel文件"按钮选择要合并的文件（最多5个）
3) 点击"选择输出模板"按钮选择输出模板文件
4) 点击"合并文件"按钮开始处理
5) 等待进度条完成
6) 合并后的文件将自动保存到桌面

3. 功能特点
-----------
- 支持同时选择多个Excel文件进行合并（最多5个）
- 自动验证文件格式和表头结构
- 智能识别表头位置（支持第4行或第5行的表头）
- 自动按工作开始时间排序
- 自动标记重复行（浅红色背景）
- 支持选择输出模板文件
- 保持模板文件的原始格式和列宽
- 自动调整时间格式为 YYYY/MM/DD
- 自动生成序号（从1开始递增）
- 显示处理进度条
- 输出文件自动保存到桌面

4. 注意事项
-----------
1) 输入文件要求：
   - 必须是Excel文件（.xlsx格式）
   - 表头可以位于第4行或第5行（程序会自动识别）
   - B列表头必须为"作业类型（内容）"
   - 必须包含所有必要列（序号、作业类型等）

2) 输出模板要求：
   - 必须是Excel文件（.xlsx格式）
   - 合并后的数据将从第7行开始写入
   - 模板文件的列宽将被保留

3) 输出文件：
   - 自动保存到桌面
   - 文件名格式：施工合并_三级_YYYYMMDD.xlsx
   - 自动调整行高以显示完整内容
   - 单元格格式：垂直居中、水平居中、自动换行

5. 常见问题
-----------
Q: 如何清除已选择的文件？
A: 点击"清除选择"按钮即可清除已选择的文件，然后可以重新选择。

Q: 为什么有些行显示为浅红色？
A: 浅红色标记表示这些行是重复的数据。

Q: 合并后的数据从哪一行开始？
A: 合并后的数据从模板文件的第7行开始写入。

Q: 如果我的表头不在第5行怎么办？
A: 新版本支持第4行或第5行的表头位置，程序会自动识别。

Q: 程序如何判断表格是否符合要求？
A: 程序会检查表头结构，特别是B列必须为"作业类型（内容）"，并且必须包含所有必要的列。

6. 联系方式
-----------
如有问题请联系系统管理员。

7. 更新记录
-----------
2024-06-30:
- 优化表头识别功能，现在支持第4行或第5行的表头
- 增加B列表头名称验证，确保为"作业类型（内容）"
- 提高文件解析的兼容性和稳定性

2024-03-21:
- 添加输出模板选择功能
- 优化序号生成逻辑
- 保持模板文件原始列宽
- 添加进度条显示
- 优化时间格式显示
- 输出文件自动保存到桌面 